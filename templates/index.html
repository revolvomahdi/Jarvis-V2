<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimal-ui">
    <meta name="theme-color" content="#212121">
    <title>JARVIS AI</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/style.css">

    <!-- Icons (Optional: Feather Icons or embedded SVGs is better for performance) -->
    <!-- Using inline SVGs for speed and no external deps -->
</head>

<body>
    <!-- SIDEBAR -->
    <div class="sidebar" id="sidebar">
        <!-- New Chat Button -->
        <div class="sidebar-header">
            <button class="new-chat-btn" onclick="newChat()">
                <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round"
                    stroke-linejoin="round" height="16" width="16" xmlns="http://www.w3.org/2000/svg">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Yeni sohbet
            </button>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-input-wrapper">
                <svg class="search-icon" stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24"
                    stroke-linecap="round" stroke-linejoin="round" height="16" width="16"
                    xmlns="http://www.w3.org/2000/svg">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" placeholder="Sohbetleri ara" class="sidebar-search">
                <span class="shortcut-hint">Ctrl + K</span>
            </div>
        </div>

        <!-- Menu Navigation -->
        <div class="nav-menu">
            <div class="nav-item" onclick="showGallery()">
                <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round"
                    stroke-linejoin="round" height="18" width="18" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                G√∂rseller
            </div>
            <div class="nav-item" onclick="showToast('Uygulamalar B√∂l√ºm√º Yakƒ±nda!')">
                <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round"
                    stroke-linejoin="round" height="18" width="18" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                Uygulamalar <span class="badge">YAKINDA</span>
            </div>
            <!-- Codex Removed -->
            <div class="nav-item" onclick="showToast('Projeler B√∂l√ºm√º Yakƒ±nda!')">
                <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round"
                    stroke-linejoin="round" height="18" width="18" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                </svg>
                Projeler <span class="badge">YAKINDA</span>
            </div>
            <div class="nav-item" onclick="startImageMode()">
                <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round"
                    stroke-linejoin="round" height="18" width="18" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
                    <path d="M2 2l7.586 7.586"></path>
                    <circle cx="11" cy="11" r="2"></circle>
                </svg>
                Sanat√ßƒ± AI
            </div>
        </div>

        <!-- History -->
        <div class="history-list" id="history-list">
            <div class="history-active-label">Son 7 G√ºn</div>
            <!-- Dynamic Injection Here -->
        </div>

        <!-- Footer -->
        <div class="sidebar-footer">
            <div class="user-profile" onclick="openSettings()">
                <!-- User Avatar -->
                <div class="user-avatar">
                    S
                </div>
                <div style="font-weight: 500; font-size: 14px;">User</div>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <main class="main-content">

        <!-- Mobile Header -->
        <header class="top-bar">
            <button class="btn-icon" onclick="toggleSidebar()">‚ò∞</button>
            <span style="font-weight: 600;">JARVIS AI</span>
            <button class="btn-icon" onclick="newChat()">+</button>
        </header>

        <!-- Model Selector -->
        <div
            style="position: absolute; top:0; left:0; width:100%; display: flex; justify-content: center; padding: 10px; z-index: 10;">
            <div class="model-selector active" id="model-display" onclick="toggleModelMode()" style="cursor: pointer;">
                JARVIS PRO 1.0 <span style="opacity:0.5; font-size:10px; margin-left:5px">‚ñº</span>
            </div>
        </div>

        <!-- CHAT AREA -->
        <div class="chat-area" id="scroll-container">
            <div class="chat-inner-container" id="chat-box" style="padding-bottom: 120px;">
                <!-- WELCOME SCREEN -->
                <div class="welcome-screen" id="welcome-screen">
                    <div class="nasalogo">
                        üß†
                    </div>
                    <h2 style="font-weight: 600; margin-bottom: 20px; font-size: 24px;">Nasƒ±l yardƒ±mcƒ± olabilirim?</h2>
                </div>
            </div>
        </div>

        <!-- INPUT AREA -->
        <div class="input-bg-gradient">
            <div class="input-container">
                <div class="input-box-rounded">

                    <!-- Plus Button -->
                    <button class="btn-circle-action">
                        <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24"
                            stroke-linecap="round" stroke-linejoin="round" height="20" width="20"
                            xmlns="http://www.w3.org/2000/svg">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>

                    <!-- Text Area -->
                    <textarea id="msg-input" placeholder="Herhangi bir ≈üey sor" rows="1"
                        oninput="autoResize(this)"></textarea>

                    <!-- Right Icons -->
                    <div class="right-input-actions">
                        <!-- Mic -->
                        <button class="btn-icon-input">
                            <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24"
                                stroke-linecap="round" stroke-linejoin="round" height="20" width="20"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                <line x1="12" y1="19" x2="12" y2="23"></line>
                                <line x1="8" y1="23" x2="16" y2="23"></line>
                            </svg>
                        </button>
                        <!-- Voice Mode / Send -->
                        <button id="send-btn" class="btn-voice-mode" disabled onclick="sendMessage()">
                            <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24"
                                stroke-linecap="round" stroke-linejoin="round" height="20" width="20"
                                xmlns="http://www.w3.org/2000/svg">
                                <line x1="22" y1="2" x2="11" y2="13"></line>
                                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                            </svg>
                        </button>
                    </div>

                </div>
                <div class="disclaimer">
                    JARVIS hatalar yapabilir. √ñnemli bilgileri kontrol edin.
                </div>
            </div>
        </div>

    </main>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ayarlar</h3>
                <button class="btn-close" onclick="closeSettings()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label>Tema</label>
                    <select id="theme-selector" onchange="changeTheme()">
                        <option>Sistem</option>
                        <option>Koyu</option>
                        <option>A√ßƒ±k</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Dil</label>
                    <select>
                        <option>T√ºrk√ße</option>
                        <option>English</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Yapay Zeka Motoru</label>
                    <select id="model-selector" onchange="changeModel()">
                        <option value="cloud">JARVIS Cloud (Pro)</option>
                        <option value="local">Yerel (Llama 3)</option>
                    </select>
                </div>
                <!-- Voice Settings Section -->
                <div class="setting-group" style="padding-top: 20px; border-top: 1px solid #444;">
                    <label style="color: var(--accent-cyan); margin-bottom: 20px; font-weight:600; display:block;">Ses
                        Ayarlarƒ± üé§</label>

                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom:15px; background:#1f1f1f; padding:10px; border-radius:6px;">
                        <label style="margin-bottom:0; cursor:pointer;" for="voice-toggle">Sesli Yanƒ±t (Jarvis)</label>
                        <label class="switch">
                            <input type="checkbox" id="voice-toggle">
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <label style="font-size:12px; color:#aaa; margin-bottom:5px; display:block;">Karakter Se√ßimi</label>
                    <select id="voice-preset" onchange="toggleCustomVoiceInput()" style="margin-bottom:10px;">
                        <option value="">Varsayƒ±lan (Rachel)</option>
                        <option value="8eSMFxjAUgbRqmAkLPBt">√áiƒüdem (TR - Kadƒ±n)</option>
                        <option value="FvxJI7vwUDkTkEOO7nd7">Pelin (TR - Kadƒ±n)</option>
                        <option value="o9DOmAyPjfFu8AfoFAnM">Nazlƒ± (TR - Kadƒ±n)</option>
                        <option value="c1An0BcfdBgMtEqajijL">Berke (TR - Erkek)</option>
                        <option value="OaQfGOEvUip9NEh44CYG">Yavuz Selim (TR - Erkek)</option>
                        <option value="VU4rWgX2OfLkqUsPis02">Mahdi (TR - Erkek)</option>
                        <option value="Gfpl8Yo74Is0W6cPUWWT">Max (EN - Erkek)</option>
                        <option value="uYXf8XasLslADfZ2MB4u">Hope (EN - Kadƒ±n)</option>
                        <option value="custom">‚úçÔ∏è √ñzel Voice ID Gir...</option>
                    </select>

                    <div id="custom-voice-container" style="display:none; margin-top:5px;">
                        <input type="text" id="voice-id-input" placeholder="ElevenLabs ID yapƒ±≈ütƒ±rƒ±n..."
                            style="width: 100%; padding: 10px; background: #2a2a2a; border: 1px solid #555; border-radius: 6px; color: white; outline: none; font-size:13px;">
                    </div>
                </div>
                <!-- System Controls -->
                <div class="setting-group" style="padding-top: 20px; border-top: 1px solid #444;">
                    <label style="color: #ff6b6b; margin-bottom: 10px;">Kontrol Paneli</label>
                    <button class="btn-save" style="background:#ff4757; color:white; width:100%;"
                        onclick="restartApp()">‚ö†Ô∏è Yeniden Ba≈ülat</button>
                    <p style="font-size:11px; color:#888; margin-top:5px;">Uygulamayƒ± ve terminali kapatƒ±p yeniden a√ßar.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-save" onclick="saveConfig()">Kaydet</button>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
    <script>
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }
        function openSettings() {
            document.getElementById('settings-modal').style.display = 'flex';
        }
        function closeSettings() {
            document.getElementById('settings-modal').style.display = 'none';
        }
        // Dismiss modal on outside click
        window.onclick = function (event) {
            const modal = document.getElementById('settings-modal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        async function changeModel() {
            const selector = document.getElementById('model-selector');
            const mode = selector.value;
            const display = document.getElementById('model-display');

            const formData = new FormData();
            formData.append('mod', mode);

            try {
                const res = await fetch('/set_model', { method: 'POST', body: formData });
                const data = await res.json();

                // Update UI Display
                if (display) display.innerHTML = data.current + ' <span style="opacity:0.5; font-size:10px; margin-left:5px">‚ñº</span>';

            } catch (e) {
                console.error("Model switch failed", e);
            }
        }
    </script>
</body>

</html>